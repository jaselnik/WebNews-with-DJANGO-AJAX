version: '3'

services:
    web:
      build:
        context: .
        args:
          requirements: requirements/development.txt
      command: >
        bash -c "python3 manage.py makemigrations
        && python3 manage.py migrate
        && python3 manage.py loaddata fixtures/categories.json
        && python3 manage.py runserver 0.0.0.0:8000"
      ports:
       - '8000:8000'
      depends_on:
       - db
      volumes:
       - .:/code
      environment:
       - DJANGO_SETTINGS_MODULE=ajax_web_news.settings.dev

    db:
      image: 'postgres:latest'
      environment:
      - POSTGRES_DB=postgres
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
